import{j as s,P as L,i as $,e as q,f as E,k as U,r as h,T as Q,l as A,m as M,u as W,c as H,A as b,h as R}from"./index-CcnX_Orc.js";import{g as T,S as F}from"./ScrollTrigger-AqcikRin.js";const O="_shopItemDetails_7qn30_1",z="_shopItemContainer_7qn30_7",G="_detailsWrapper_7qn30_17",J="_tabsCard_7qn30_31",K="_hrTabs_7qn30_40",V="_backButton_7qn30_47",X="_spinner_7qn30_59",d={shopItemDetails:O,shopItemContainer:z,detailsWrapper:G,tabsCard:J,hrTabs:K,backButton:V,spinner:X},Y="_allTabs_1vh7q_1",Z="_btnTabs_1vh7q_9",ss="_selected_1vh7q_30",es="_tabInfo_1vh7q_39",ts="_tabContent_1vh7q_44",as="_itemList_1vh7q_50",ns="_listLeft_1vh7q_56",is="_listTitle_1vh7q_63",cs="_listDescription_1vh7q_70",o={allTabs:Y,btnTabs:Z,selected:ss,tabInfo:es,tabContent:ts,itemList:as,listLeft:ns,listTitle:is,listDescription:cs},ls=({fullDescription:t})=>s.jsx("div",{className:o.tabInfo,children:s.jsx("p",{className:o.tabContent,children:t})}),rs=({brand:t,productType:a,productWidth:n,productHeight:i,productThickness:c,category:l,applying:p})=>s.jsxs("div",{className:o.detailedItemList,children:[s.jsx("h3",{children:"Характеристики"}),s.jsx("br",{}),s.jsxs("div",{className:o.itemList,children:[t&&s.jsxs("div",{className:o.listLeft,children:[s.jsx("span",{className:o.listTitle,children:"Бренд: "}),s.jsx("span",{className:o.listDescription,children:t})]}),a&&s.jsxs("div",{className:o.listLeft,children:[s.jsx("span",{className:o.listTitle,children:"Тип товара: "}),s.jsx("span",{className:o.listDescription,children:a})]}),l&&s.jsxs("div",{className:"list-left",children:[s.jsx("p",{className:"list-title",children:"Категория: "}),s.jsx("p",{className:"list-description",children:l})]}),p&&s.jsxs("div",{className:"list-left",children:[s.jsx("p",{className:"list-title",children:"Применение: "}),s.jsx("p",{className:"list-description",children:p})]}),n&&s.jsxs("div",{className:"list-left",children:[s.jsx("p",{className:"list-title",children:"Ширина: "}),s.jsxs("p",{className:"list-description",children:[n," мм"]})]}),i&&s.jsxs("div",{className:"list-left",children:[s.jsx("p",{className:"list-title",children:"Высота: "}),s.jsxs("p",{className:"list-description",children:[i," мм"]})]}),c&&s.jsxs("div",{className:"list-left",children:[s.jsx("p",{className:"list-title",children:"Толщина: "}),s.jsxs("p",{className:"list-description",children:[c," мм"]})]})]})]}),os=({tab:t,index:a,activeTab:n,setActiveTab:i})=>{const c=a===n;return s.jsx("button",{className:`${o.btnTabs} ${c?o.selected:""}`,onClick:()=>i(a),"aria-selected":c,role:"tab",children:t})},ds=({activeTab:t,setActiveTab:a,tabs:n=["ОПИСАНИЕ","ДЕТАЛИ"]})=>s.jsx("div",{className:o.allTabs,children:n.map((i,c)=>s.jsx(os,{tab:i,index:c,activeTab:t,setActiveTab:a},i))}),ms=({quantity:t,setQuantity:a})=>{const n=()=>{const c=t+1;a(c)},i=()=>{if(t<=1)return;const c=t-1;a(c)};return s.jsxs("div",{className:"addedItems",children:[s.jsx("button",{className:"addDeleteBtn",onClick:i,children:s.jsx(L,{className:"minus"})}),s.jsx("span",{className:"addedQuantity",children:t}),s.jsx("button",{className:"addDeleteBtn",onClick:n,children:s.jsx($,{})})]})},hs="_shopItemDetailsInfo_1ank9_1",ps="_detailedItemsHeading_1ank9_5",_s="_column_1ank9_20",us="_relative_1ank9_26",xs="_itemImageDetailed_1ank9_30",js="_newBadge_1ank9_42",Ns="_newSign_1ank9_54",gs="_columnLeft_1ank9_58",Is="_detailedItemName_1ank9_66",fs="_detailedItemPrice_1ank9_76",bs="_addedItems_1ank9_83",vs="_ctaButton_1ank9_90",Ts="_shoppingBagIcon_1ank9_126",ys="_errorMessage_1ank9_131",r={shopItemDetailsInfo:hs,detailedItemsHeading:ps,column:_s,relative:us,itemImageDetailed:xs,newBadge:js,newSign:Ns,columnLeft:gs,detailedItemName:Is,detailedItemPrice:fs,addedItems:bs,ctaButton:vs,shoppingBagIcon:Ts,errorMessage:ys};T.registerPlugin(F);const Cs=({image:t,name:a,price:n,quantity:i,setQuantity:c,product:l})=>{const p=q(),N=E(U),m=l?._id||l?.id,g=N.some(e=>e.productId===m||e.productId===l?._id||e.productId===l?.id),j=()=>{if(!m){console.error("Product ID is undefined",l);return}p(g?A({productId:m,quantity:i}):M({product:{...l,id:m,_id:l?._id},quantity:i}))},_=h.useRef([]);_.current=[],h.useEffect(()=>{_.current.forEach(e=>{T.fromTo(e,{y:50,opacity:0},{y:0,opacity:1,duration:.7,scrollTrigger:{trigger:e,start:"top bottom-=70",toggleActions:"play none none reverse"}})})},[]);const u=e=>{e&&!_.current.includes(e)&&_.current.push(e)},I=e=>!e&&e!==0?"Цена не указана":new Intl.NumberFormat("ru-RU").format(e)+" руб.",f=e=>{e.target.onerror=null,e.target.src="/src/shared/assets/shop/default-product.svg"};return s.jsx("div",{className:r.shopItemDetailsInfo,children:s.jsxs("div",{className:r.detailedItemsHeading,children:[s.jsxs("div",{className:`${r.column} ${r.relative}`,ref:u,children:[s.jsx("img",{className:r.itemImageDetailed,src:t||"/src/shared/assets/shop/default-product.svg",alt:a||"Товар",onError:f}),s.jsx("div",{className:r.newBadge,children:s.jsx("p",{className:r.newSign,children:"Участвует в акции"})})]}),s.jsxs("div",{className:r.columnLeft,children:[s.jsx("p",{className:r.detailedItemName,ref:u,children:a||l?.name||"Название товара не указано"}),s.jsx("p",{className:r.detailedItemPrice,ref:u,children:I(n)}),s.jsx("div",{className:r.addedItems,ref:u,children:s.jsx(ms,{quantity:i,setQuantity:c})}),s.jsxs("div",{children:[s.jsxs("button",{className:r.ctaButton,onClick:j,disabled:!m,children:[s.jsx(Q,{className:r.shoppingBagIcon}),g?"Добавить еще":"Добавить в корзину"]}),!m&&s.jsx("p",{className:r.errorMessage,children:"Ошибка: ID товара не определен"})]})]})]})})},Ss=()=>{const t=W(),{id:a}=H(),[n,i]=h.useState(null),[c,l]=h.useState(!0),[p,N]=h.useState(null),[m,g]=h.useState(1),[j,_]=h.useState(0);if(h.useEffect(()=>{(async()=>{if(a)try{l(!0),N(null);const x=(await R.get(b.getShopItemUrl(a))).data;x&&!x.imageUrl&&x.image&&(x.imageUrl=b.getImageUrl(x.image)),i(x)}catch(v){console.error("Fetch product error:",v),N("Товар не найден")}finally{l(!1)}})()},[a]),c)return s.jsx("div",{className:`container py-5 ${d.shopItemContainer}`,children:s.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center py-5",children:[s.jsx("div",{className:`spinner-border text-primary ${d.spinner}`,role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Загрузка..."})}),s.jsx("p",{className:"mt-3",children:"Загрузка товара..."})]})});if(p||!n)return s.jsx("div",{className:`container py-5 ${d.shopItemContainer}`,children:s.jsx("div",{className:"card shadow border-0 text-center py-5",children:s.jsxs("div",{className:"card-body",children:[s.jsx("h2",{className:"text-danger mb-3",children:"Товар не найден"}),s.jsx("p",{className:"text-muted mb-4",children:"Извините, запрошенный товар не существует или был удален."}),s.jsx("button",{className:"btn btn-primary",onClick:()=>t("/shop"),children:"Вернуться в магазин"})]})})});const u=n.imageUrl||b.getImageUrl(n.image),{price:I,name:f,applying:e,fullDescription:y,brand:C,productType:D,productWidth:k,productHeight:B,productThickness:S,title:P,category:w}=n;return s.jsx("div",{className:d.shopItemDetails,children:s.jsx("section",{className:`container py-4 ${d.shopItemContainer}`,children:s.jsx("div",{className:"row justify-content-center",children:s.jsx("div",{className:"col-12 col-lg-10 col-xl-8",children:s.jsxs("div",{className:d.detailsWrapper,children:[s.jsx(Cs,{image:u,name:f,price:I,applying:e,quantity:m,setQuantity:g,product:n}),s.jsx("div",{className:`card shadow-sm border-0 mt-4 ${d.tabsCard}`,children:s.jsx("div",{className:"card-body p-4",children:s.jsxs("div",{className:d.itemTabs,children:[s.jsx(ds,{activeTab:j,setActiveTab:_}),s.jsx("hr",{className:`my-4 ${d.hrTabs}`}),s.jsxs("div",{className:"tab-content mt-3",children:[j===0&&s.jsx(ls,{fullDescription:y}),j===1&&s.jsx(rs,{brand:C,productType:D,productWidth:k,productHeight:B,productThickness:S,category:w,title:P,applying:e})]})]})})}),s.jsx("div",{className:"text-center mt-4",children:s.jsxs("button",{className:`btn btn-outline-secondary ${d.backButton}`,onClick:()=>t(-1),children:[s.jsx("i",{className:"bi bi-arrow-left me-2"}),"Вернуться назад"]})})]})})})})})};export{Ss as default};
